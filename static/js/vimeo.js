/**
 * Video Plugin
 * @version 2.3.4
 * @author Bartosz Wojciechowski
 * @author David Deutsch
 * @license The MIT License (MIT)
 */(function(t,e,n){var i=function(e){this._core=e,this._videos={},this._playing=null,this._handlers={"initialized.owl.carousel":t.proxy(function(t){t.namespace&&this._core.register({type:'state',name:'playing',tags:['interacting']})},this),"resize.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.video&&this.isInFullScreen()&&t.preventDefault()},this),"refreshed.owl.carousel":t.proxy(function(t){t.namespace&&this._core.is('resizing')&&this._core.$stage.find('.cloned .owl-video-frame').remove()},this),"changed.owl.carousel":t.proxy(function(t){t.namespace&&'position'===t.property.name&&this._playing&&this.stop()},this),"prepared.owl.carousel":t.proxy(function(n){if(n.namespace){var e=t(n.content).find('.owl-video');e.length&&(e.css('display','none'),this.fetch(e,t(n.content)))}},this)},this._core.options=t.extend({},i.Defaults,this._core.options),this._core.$element.on(this._handlers),this._core.$element.on('click.owl.video','.owl-video-play-icon',t.proxy(function(t){this.play(t)},this))};i.Defaults={video:!1,videoHeight:!1,videoWidth:!1},i.prototype.fetch=function(e,t){var n=function(){return e.attr('data-vimeo-id')?'vimeo':e.attr('data-vzaar-id')?'vzaar':'youtube'}(),i=e.attr('data-vimeo-id')||e.attr('data-youtube-id')||e.attr('data-vzaar-id'),o=e.attr('data-width')||this._core.settings.videoWidth,a=e.attr('data-height')||this._core.settings.videoHeight,s=e.attr('href');if(s){if(i=s.match(/(http:|https:|)\/\/(player.|www.|app.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com|be\-nocookie\.com)|vzaar\.com)\/(video\/|videos\/|embed\/|channels\/.+\/|groups\/.+\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),-1<i[3].indexOf('youtu'))n='youtube';else if(-1<i[3].indexOf('vimeo'))n='vimeo';else if(-1<i[3].indexOf('vzaar'))n='vzaar';else throw new Error('Video URL not supported.');i=i[6]}else throw new Error('Missing video URL.');this._videos[s]={type:n,id:i,width:o,height:a},t.attr('data-video',s),this.thumbnail(e,this._videos[s])},i.prototype.thumbnail=function(e,n){var i=n.width&&n.height?'width:'+n.width+'px;height:'+n.height+'px;':'',o=e.find('img'),a='src',s='',r=this._core.settings,l=function(n){p='<div class="owl-video-play-icon"></div>',d=r.lazyLoad?t('<div/>',{class:'owl-video-tn '+s,srcType:n}):t('<div/>',{class:'owl-video-tn',style:'opacity:1;background-image:url('+n+')'}),e.after(d),e.after(p)},d,p,c;return e.wrap(t('<div/>',{class:'owl-video-wrapper',style:i})),this._core.settings.lazyLoad&&(a='data-src',s='owl-lazy'),o.length?(l(o.attr(a)),o.remove(),!1):void('youtube'===n.type?(c='//img.youtube.com/vi/'+n.id+'/hqdefault.jpg',l(c)):'vimeo'===n.type?t.ajax({type:'GET',url:'//vimeo.com/api/v2/video/'+n.id+'.json',jsonp:'callback',dataType:'jsonp',success:function(e){c=e[0].thumbnail_large,l(c)}}):'vzaar'===n.type&&t.ajax({type:'GET',url:'//vzaar.com/api/videos/'+n.id+'.json',jsonp:'callback',dataType:'jsonp',success:function(e){c=e.framegrab_url,l(c)}}))},i.prototype.stop=function(){this._core.trigger('stop',null,'video'),this._playing.find('.owl-video-frame').remove(),this._playing.removeClass('owl-video-playing'),this._playing=null,this._core.leave('playing'),this._core.trigger('stopped',null,'video')},i.prototype.play=function(e){var n=t(e.target),i=n.closest('.'+this._core.settings.itemClass),o=this._videos[i.attr('data-video')],a=o.width||'100%',s=o.height||this._core.$stage.height(),r,l;this._playing||(this._core.enter('playing'),this._core.trigger('play',null,'video'),i=this._core.items(this._core.relative(i.index())),this._core.reset(i.index()),r=t('<iframe frameborder="0" allowfullscreen mozallowfullscreen webkitAllowFullScreen ></iframe>'),r.attr('height',s),r.attr('width',a),'youtube'===o.type?r.attr('src','//www.youtube.com/embed/'+o.id+'?autoplay=1&rel=0&v='+o.id):'vimeo'===o.type?r.attr('src','//player.vimeo.com/video/'+o.id+'?autoplay=1'):'vzaar'===o.type&&r.attr('src','//view.vzaar.com/'+o.id+'/player?autoplay=true'),l=t(r).wrap('<div class="owl-video-frame" />').insertAfter(i.find('.owl-video')),this._playing=i.addClass('owl-video-playing'))},i.prototype.isInFullScreen=function(){var e=n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement;return e&&t(e).parent().hasClass('owl-video-frame')},i.prototype.destroy=function(){var e,t;for(e in this._core.$element.off('click.owl.video'),this._handlers)this._core.$element.off(e,this._handlers[e]);for(t in Object.getOwnPropertyNames(this))'function'!=typeof this[t]&&(this[t]=null)},t.fn.owlCarousel.Constructor.Plugins.Video=i})(window.Zepto||window.jQuery,window,document);